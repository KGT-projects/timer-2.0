<!DOCTYPE html>
<html>
<head><title>Timer</title><meta name="viewport" content="width=device-width,width=1"><style>
  body { margin:0; height:100vh; display:flex; font-size:8vw; justify-content:center; align-items:center; background:white;color:black;font-family:sans-serif;}
  #timer{touch-action:none;}
</style></head>
<body>
  <div id="timer">--:--:--</div>
  <script>
    let timeLeft = 0, lastSync = 0;

    function hhmmss(sec) {
      const h = String(Math.floor(sec/3600)).padStart(2,0);
      const m = String(Math.floor(sec%3600/60)).padStart(2,0);
      const s = String(sec%60).padStart(2,0);
      return `${h}:${m}:${s}`;
    }

    async function syncTime() {
      const res = await fetch('time.json?nocache=' + Date.now());
      const data = await res.json();
      timeLeft = data.timeLeft;
      lastSync = Date.now();
      display();
    }

    function display() {
      document.getElementById('timer').textContent = hhmmss(timeLeft);
    }

    setInterval(() => {
      const elapsed = Math.floor((Date.now() - lastSync) / 1000);
      timeLeft = Math.max(0, timeLeft - elapsed);
      lastSync = Date.now();
      display();
    }, 1000);

    setInterval(syncTime, 3000);
    syncTime();

    let lastTap=0;
    document.body.addEventListener('touchend', () => {
      const now=Date.now();
      if (now-lastTap<300) {
        document.documentElement.requestFullscreen?.();
      }
      lastTap=now;
    });
  </script>
</body>
</html>
